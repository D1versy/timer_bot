#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–æ—Ç–∞

echo "‚ö†Ô∏è –û—Å—Ç–∞–Ω–æ–≤–∫–∞ L2M Boss Tracker Bot..."

# –ü–æ–∏—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞
PIDS=$(ps aux | grep "python.*bot.py" | grep -v grep | awk '{print $2}')

if [ -z "$PIDS" ]; then
    echo "‚ÑπÔ∏è –ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω"
    exit 0
fi

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
for PID in $PIDS; do
    echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –ø—Ä–æ—Ü–µ—Å—Å $PID..."
    kill -SIGTERM $PID 2>/dev/null

    # –ñ–¥—ë–º 3 —Å–µ–∫—É–Ω–¥—ã
    sleep 3

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –ª–∏
    if ps -p $PID > /dev/null 2>&1; then
        echo "‚ö†Ô∏è –ü—Ä–æ—Ü–µ—Å—Å $PID –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞..."
        kill -9 $PID 2>/dev/null
    fi
done

echo "‚úÖ –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"